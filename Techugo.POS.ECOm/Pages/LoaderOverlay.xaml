<UserControl x:Class="Techugo.POS.ECOm.Pages.LoaderOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:svc="clr-namespace:Techugo.POS.ECOm.Services"
             Height="Auto" Width="Auto" IsHitTestVisible="False"
             Loaded="UserControl_Loaded">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <SolidColorBrush x:Key="OverlayBrush" Color="#80000000"/>
        <!-- dimmer -->
        <SolidColorBrush x:Key="CardBrush" Color="#FFFFFFFF"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#1976D2"/>

        <!-- 8-dot staggered opacity animation -->
        <Storyboard x:Key="DotsStoryboard" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="Dot0" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0"/>
            <DoubleAnimation Storyboard.TargetName="Dot1" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.075"/>
            <DoubleAnimation Storyboard.TargetName="Dot2" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.150"/>
            <DoubleAnimation Storyboard.TargetName="Dot3" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.225"/>
            <DoubleAnimation Storyboard.TargetName="Dot4" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.300"/>
            <DoubleAnimation Storyboard.TargetName="Dot5" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.375"/>
            <DoubleAnimation Storyboard.TargetName="Dot6" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.450"/>
            <DoubleAnimation Storyboard.TargetName="Dot7" Storyboard.TargetProperty="Opacity" From="0.25" To="1"
                             Duration="0:0:0.6" AutoReverse="True" BeginTime="0:0:0.525"/>
        </Storyboard>
    </UserControl.Resources>

    <Grid Visibility="{Binding IsLoading, Source={StaticResource LoadingServiceInstance}, Converter={StaticResource BoolToVis}}"
          IsHitTestVisible="{Binding IsLoading, Source={StaticResource LoadingServiceInstance}}">
        <!-- Dimmer -->
        <Rectangle Fill="{StaticResource OverlayBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        <!-- Center card -->
        <Border Width="320" Padding="18" Background="{StaticResource CardBrush}" CornerRadius="10"
                HorizontalAlignment="Center" VerticalAlignment="Center" >
            <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="4">
                <!-- 8-dot loader -->
                <Canvas Width="64" Height="64" HorizontalAlignment="Center" Margin="4">
                    <!-- center = 32,32 radius = 18, dot size = 8 -->
                    <Ellipse x:Name="Dot0" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="28" Canvas.Top="10"/>
                    <Ellipse x:Name="Dot1" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="40.73" Canvas.Top="15.27"/>
                    <Ellipse x:Name="Dot2" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="46" Canvas.Top="28"/>
                    <Ellipse x:Name="Dot3" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="40.73" Canvas.Top="40.73"/>
                    <Ellipse x:Name="Dot4" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="28" Canvas.Top="46"/>
                    <Ellipse x:Name="Dot5" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="15.27" Canvas.Top="40.73"/>
                    <Ellipse x:Name="Dot6" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="10" Canvas.Top="28"/>
                    <Ellipse x:Name="Dot7" Width="8" Height="8" Fill="{StaticResource AccentBrush}" Opacity="0.25" Canvas.Left="15.27" Canvas.Top="15.27"/>
                </Canvas>

                <!-- Message -->
                <TextBlock Text="{Binding Message, Source={StaticResource LoadingServiceInstance}, FallbackValue='Loading...'}"
                           Foreground="#222" FontSize="14" FontWeight="SemiBold" Margin="0,12,0,0" TextAlignment="Center"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>